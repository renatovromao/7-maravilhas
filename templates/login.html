{% extends "base.html" %}

{% block title %}Início{% endblock %}

{% block content %}
<div class="row w-100 justify-content-center">
    <div class="col-11 col-sm-10 col-md-8 col-lg-6 text-center p-2 bg-white rounded-3 shadow-sm">

        <h2 class="mb-3">Bem-vindo</h2>

        <p class="text-muted mb-4">
            Digite seu nome e escolha quem vai caminhar com você nesta jornada.
        </p>

        {% if error %}
            <div class="alert alert-danger">
                {{ error }}
            </div>
        {% endif %}

        <form method="post" action="{{ url_for('login') }}" id="loginForm">

            <!-- Nome -->
            <div class="mb-4 name-journey">
                <input
                    type="text"
                    name="nome"
                    id="nomeInput"
                    class="form-control form-control-lg text-center"
                    placeholder="Seu nome"
                    required
                >
            </div>

            <!-- Escolha do personagem -->
            <h5 class="mb-3">Escolha um personagem</h5>

            <div class="row g-3 mb-4">

                <!-- Personagem 1 -->
                <div class="col-6">
                    <div class="character-card" data-character="personagem1">
                        <img
                            src="{{ url_for('static', filename='img/personagens/personagem1.png') }}"
                            alt="Sir RatBárbaro"
                        >
                        <div class="character-name">
                            Sir RatBárbaro
                        </div>
                    </div>
                </div>

                <!-- Personagem 2 -->
                <div class="col-6">
                    <div class="character-card" data-character="personagem2">
                        <img
                            src="{{ url_for('static', filename='img/personagens/personagem2.png') }}"
                            alt="Sir RatBispo"
                        >
                        <div class="character-name">
                            Sir RatBispo
                        </div>
                    </div>
                </div>

            </div>

            <!-- Input hidden -->
            <input type="hidden" name="personagem" id="personagemInput">

            <!-- Botão entrar -->
            <button
                type="submit"
                id="enterBtn"
                class="btn btn-primary btn-lg w-100"
                disabled
            >
                Entrar
            </button>

        </form>

    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener("DOMContentLoaded", () => {

    const cards = document.querySelectorAll(".character-card");
    const personagemInput = document.getElementById("personagemInput");
    const nomeInput = document.getElementById("nomeInput");
    const enterBtn = document.getElementById("enterBtn");

    let selectedCharacter = null;

    // Seleção de personagem
    cards.forEach(card => {
        card.addEventListener("click", () => {
            cards.forEach(c => c.classList.remove("selected"));
            card.classList.add("selected");

            selectedCharacter = card.dataset.character;
            personagemInput.value = selectedCharacter;

            validateForm();
        });
    });

    // Validação do formulário
    nomeInput.addEventListener("input", validateForm);

    function validateForm() {
        if (nomeInput.value.trim() !== "" && selectedCharacter) {
            enterBtn.disabled = false;
        } else {
            enterBtn.disabled = true;
        }
    }

});
</script>
{% endblock %}
